#Implementation from https://github.com/shreelock/gbvs